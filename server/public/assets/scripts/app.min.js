/*! parking_app 2015-05-28 */
var app=angular.module("app",[]);app.controller("IndexController",["$scope","$http",function(a,b){L.mapbox.accessToken="pk.eyJ1Ijoia2FpdGxpbm11dGgiLCJhIjoiNzZmNzg3OTE5N2ExMTgxNTcxYzdiM2RlMGQxN2Q2YzcifQ.YENWVyAaFMg0ngZEc1aP7A";var c=L.mapbox.tileLayer("mapbox.pencil"),d=L.map("map").addLayer(c).setView([44.832419,-93.300534],15),e=function(a,b){console.log("Dropping pin at ",a," ",b),L.marker([a,b]).addTo(d)};a.mapStyle={width:"100%"},a.spot={};var f=function(){return b.post("/spot",a.spot)};a.setPosition=function(b){return console.log("set position",b),a.spot.created=new Date,a.spot.latitude=b.coords.latitude,a.spot.longitude=b.coords.longitude,console.log("spot set to",a.spot),e(a.spot.latitude,a.spot.longitude),f()},a.getPosition=function(){if(console.log("Clicked!"),navigator.geolocation){console.log("Locating...");navigator.geolocation.getCurrentPosition(a.setPosition,g,{enableHighAccuracy:!0,timeout:1e7,maximumAge:0})}else alert("Geolocation is not supported by this browser.")};var g=function(a){var b={1:"Permission denied",2:"Position unavailable",3:"Request timeout"};alert("Error: "+b[a.code])}}]);